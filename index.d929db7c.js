var e={};function t(e){if(!Array.isArray(e))return console.error("Expected field to be an array."),e;let t=[];for(let i=0;i<e.length;i++)for(let l=0;l<e[i].length;l++)0===e[i][l]&&t.push({x:i,y:l});if(0===t.length)return n&&n.classList.remove("hidden"),e;let i=Math.floor(Math.random()*t.length),{x:l,y:r}=t[i];return e[l][r]=.9>Math.random()?2:4,e}function i(e,t,i){let l=!1,r=Array(t).fill(!1);switch(i){case"left":for(let i=0;i<t;i++)for(let l=1;l<t;l++)if(0!==e[i][l]){let t=l;for(;t>0&&0===e[i][t-1];)e[i][t-1]=e[i][t],e[i][t]=0,t--}break;case"right":for(let i=0;i<t;i++)for(let l=t-2;l>=0;l--)if(0!==e[i][l]){let r=l;for(;r<t-1&&0===e[i][r+1];)e[i][r+1]=e[i][r],e[i][r]=0,r++}break;case"up":for(let i=0;i<t;i++)for(let l=1;l<t;l++)if(0!==e[l][i]){let t=l;for(;t>0&&0===e[t-1][i];)e[t-1][i]=e[t][i],e[t][i]=0,t--}break;case"down":for(let i=0;i<t;i++)for(let l=t-2;l>=0;l--)if(0!==e[l][i]){let r=l;for(;r<t-1&&0===e[r+1][i];)e[r+1][i]=e[r][i],e[r][i]=0,r++}break;default:throw Error(`Invalid direction: ${i}`)}switch(i){case"left":for(let i=0;i<t;i++)for(let a=1;a<t;a++)0===e[i][a]||e[i][a]!==e[i][a-1]||r[a-1]||(e[i][a-1]*=2,e[i][a]=0,r[a-1]=!0,l=!0);break;case"right":for(let i=0;i<t;i++)for(let a=t-2;a>=0;a--)0===e[i][a]||e[i][a]!==e[i][a+1]||r[a+1]||(e[i][a+1]*=2,e[i][a]=0,r[a+1]=!0,l=!0);break;case"up":for(let i=0;i<t;i++)for(let a=1;a<t;a++)0===e[a][i]||e[a][i]!==e[a-1][i]||r[a-1]||(e[a-1][i]*=2,e[a][i]=0,r[a-1]=!0,l=!0);break;case"down":for(let i=0;i<t;i++)for(let a=t-2;a>=0;a--)0===e[a][i]||e[a][i]!==e[a+1][i]||r[a+1]||(e[a+1][i]*=2,e[a][i]=0,r[a+1]=!0,l=!0);break;default:throw Error(`Invalid direction: ${i}`)}return{mergeOccurred:l,tileField:e}}const l="game run",r={RIGHT:"right",LEFT:"left",DOWN:"down",UP:"up"};e=class{initialState;constructor(e){this.initialState=e,console.log(this.initialState)}moveUp(){let{tileField:e}=this.initialState,l=e.length,{mergeOccurred:a,tileField:s}=i(e,l,r.UP);a&&i(s,l,r.UP),t(this.initialState.tileField),console.log(s)}moveLeft(){let{tileField:e}=this.initialState,l=e.length,{mergeOccurred:a,tileField:s}=i(e,l,r.LEFT);a&&i(s,l,r.LEFT),t(this.initialState.tileField)}moveRight(){let{tileField:e}=this.initialState,l=e.length,{mergeOccurred:a,tileField:s}=i(e,l,r.RIGHT);a&&i(s,l,r.RIGHT),t(this.initialState.tileField)}moveDown(){let{tileField:e}=this.initialState,l=e.length,{mergeOccurred:a,tileField:s}=i(e,l,r.DOWN);a&&i(s,l,r.DOWN),t(this.initialState.tileField)}getScore(){let e=0;for(let t=0;t<this.initialState.tileField.length;t++)for(let i=0;i<this.initialState.tileField[t].length;i++)e+=this.initialState.tileField[t][i];this.initialState.score=e}getState(){return this.initialState}getStatus(){console.log("Current status:",this.initialState.status)}start(){!function(e){if(!Array.isArray(e))return console.error("Expected field to be an array.");let t=[];for(let i=0;i<e.length;i++)for(let l=0;l<e[i].length;l++)0===e[i][l]&&t.push({x:i,y:l});if(t.length>=2){let i=function(e){let t=[],i=0;for(;i<4;){let l=Math.floor(Math.random()*e);!t.includes(l)&&(.1>Math.random()?(t.push(l),i++):i<2&&(t.push(l),i++))}return t}(t.length);for(let l=0;l<2;l++){let{x:r,y:a}=t[i[l]];e[r][a]=2}}else console.log("Not enough empty positions to fill.")}(this.initialState.tileField),this.initialState.status=l}restart(){this.initialState.score=0,this.initialState.tileField=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}setTile(){let e=document.querySelector(".game-field");if(e){let t=e.querySelectorAll(".field-row");for(let e=0;e<this.initialState.tileField.length;e++){let i=t[e].querySelectorAll(".field-cell");for(let t=0;t<this.initialState.tileField[e].length;t++){let l=i[t],r=this.initialState.tileField[e][t],a=`field-cell--${r}`;l.className="field-cell",0!==r?(l.classList.add(a),l.textContent=`${r}`):l.textContent=""}}}}};const a={status:"game is not started",tileField:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],score:0},s=new e(a),n=document.getElementById("message-lose"),o=document.getElementById("start"),d=document.getElementById("restart"),c=document.getElementById("game-score"),h=document.getElementById("message-start"),f=document.getElementById("message-win"),g=()=>{s.getScore(),2048===a.score&&f.classList.remove("hidden"),c.textContent=`${a.score}`},u=e=>m(e);o.addEventListener("click",()=>{s.start(),s.setTile(),s.getState().status===l&&(o.classList.add("hidden"),d.classList.remove("hidden")),n?.classList.add("hidden"),h.classList.add("hidden"),document.addEventListener("keydown",u)}),d.addEventListener("click",()=>{s.restart(),g(),s.setTile(),o.classList.remove("hidden"),d.classList.add("hidden"),n?.classList.add("hidden"),h.classList.remove("hidden"),document.removeEventListener("keydown",u)});const m=e=>{switch(e.key){case"ArrowUp":s.moveUp(),s.setTile(),g();break;case"ArrowDown":s.moveDown(),s.setTile(),g();break;case"ArrowLeft":s.moveLeft(),s.setTile(),g();break;case"ArrowRight":s.moveRight(),s.setTile(),g()}};
//# sourceMappingURL=index.d929db7c.js.map
