!function(){var e={};function t(e){if(!Array.isArray(e))return console.error("Expected field to be an array."),e;for(var t=[],i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)0===e[i][r]&&t.push({x:i,y:r});if(0===t.length)return o&&o.classList.remove("hidden"),e;var a=Math.floor(Math.random()*t.length),n=t[a],l=n.x,s=n.y;return e[l][s]=.9>Math.random()?2:4,e}function i(e,t,i){var r=!1,a=Array(t).fill(!1);switch(i){case"left":for(var n=0;n<t;n++)for(var l=1;l<t;l++)if(0!==e[n][l])for(var o=l;o>0&&0===e[n][o-1];)e[n][o-1]=e[n][o],e[n][o]=0,o--;break;case"right":for(var s=0;s<t;s++)for(var c=t-2;c>=0;c--)if(0!==e[s][c])for(var d=c;d<t-1&&0===e[s][d+1];)e[s][d+1]=e[s][d],e[s][d]=0,d++;break;case"up":for(var f=0;f<t;f++)for(var u=1;u<t;u++)if(0!==e[u][f])for(var v=u;v>0&&0===e[v-1][f];)e[v-1][f]=e[v][f],e[v][f]=0,v--;break;case"down":for(var h=0;h<t;h++)for(var g=t-2;g>=0;g--)if(0!==e[g][h])for(var m=g;m<t-1&&0===e[m+1][h];)e[m+1][h]=e[m][h],e[m][h]=0,m++;break;default:throw Error("Invalid direction: ".concat(i))}switch(i){case"left":for(var y=0;y<t;y++)for(var S=1;S<t;S++)0===e[y][S]||e[y][S]!==e[y][S-1]||a[S-1]||(e[y][S-1]*=2,e[y][S]=0,a[S-1]=!0,r=!0);break;case"right":for(var k=0;k<t;k++)for(var F=t-2;F>=0;F--)0===e[k][F]||e[k][F]!==e[k][F+1]||a[F+1]||(e[k][F+1]*=2,e[k][F]=0,a[F+1]=!0,r=!0);break;case"up":for(var w=0;w<t;w++)for(var b=1;b<t;b++)0===e[b][w]||e[b][w]!==e[b-1][w]||a[b-1]||(e[b-1][w]*=2,e[b][w]=0,a[b-1]=!0,r=!0);break;case"down":for(var L=0;L<t;L++)for(var p=t-2;p>=0;p--)0===e[p][L]||e[p][L]!==e[p+1][L]||a[p+1]||(e[p+1][L]*=2,e[p][L]=0,a[p+1]=!0,r=!0);break;default:throw Error("Invalid direction: ".concat(i))}return{mergeOccurred:r,tileField:e}}var r="game run",a={RIGHT:"right",LEFT:"left",DOWN:"down",UP:"up"};e=function(){var e;function n(e){var t,i;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),i=void 0,(t="initialState")in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i,this.initialState=e,console.log(this.initialState)}return e=[{key:"moveUp",value:function(){var e=this.initialState.tileField,r=e.length,n=i(e,r,a.UP),l=n.mergeOccurred,o=n.tileField;l&&i(o,r,a.UP),t(this.initialState.tileField),console.log(o)}},{key:"moveLeft",value:function(){var e=this.initialState.tileField,r=e.length,n=i(e,r,a.LEFT),l=n.mergeOccurred,o=n.tileField;l&&i(o,r,a.LEFT),t(this.initialState.tileField)}},{key:"moveRight",value:function(){var e=this.initialState.tileField,r=e.length,n=i(e,r,a.RIGHT),l=n.mergeOccurred,o=n.tileField;l&&i(o,r,a.RIGHT),t(this.initialState.tileField)}},{key:"moveDown",value:function(){var e=this.initialState.tileField,r=e.length,n=i(e,r,a.DOWN),l=n.mergeOccurred,o=n.tileField;l&&i(o,r,a.DOWN),t(this.initialState.tileField)}},{key:"getScore",value:function(){for(var e=0,t=0;t<this.initialState.tileField.length;t++)for(var i=0;i<this.initialState.tileField[t].length;i++)e+=this.initialState.tileField[t][i];this.initialState.score=e}},{key:"getState",value:function(){return this.initialState}},{key:"getStatus",value:function(){console.log("Current status:",this.initialState.status)}},{key:"start",value:function(){(function(e){if(!Array.isArray(e))return console.error("Expected field to be an array.");for(var t=[],i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)0===e[i][r]&&t.push({x:i,y:r});if(t.length>=2)for(var a=function(e){for(var t=[],i=0;i<4;){var r=Math.floor(Math.random()*e);!t.includes(r)&&(.1>Math.random()?(t.push(r),i++):i<2&&(t.push(r),i++))}return t}(t.length),n=0;n<2;n++){var l=t[a[n]],o=l.x,s=l.y;e[o][s]=2}else console.log("Not enough empty positions to fill.")})(this.initialState.tileField),this.initialState.status=r}},{key:"restart",value:function(){this.initialState.score=0,this.initialState.tileField=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}},{key:"setTile",value:function(){var e=document.querySelector(".game-field");if(e)for(var t=e.querySelectorAll(".field-row"),i=0;i<this.initialState.tileField.length;i++)for(var r=t[i].querySelectorAll(".field-cell"),a=0;a<this.initialState.tileField[i].length;a++){var n=r[a],l=this.initialState.tileField[i][a],o="field-cell--".concat(l);n.className="field-cell",0!==l?(n.classList.add(o),n.textContent="".concat(l)):n.textContent=""}}}],function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(n.prototype,e),n}();var n={status:"game is not started",tileField:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],score:0},l=new e(n),o=document.getElementById("message-lose"),s=document.getElementById("start"),c=document.getElementById("restart"),d=document.getElementById("game-score"),f=document.getElementById("message-start"),u=document.getElementById("message-win"),v=function(){l.getScore(),2048===n.score&&u.classList.remove("hidden"),d.textContent="".concat(n.score)},h=function(e){return g(e)};s.addEventListener("click",function(){l.start(),l.setTile(),l.getState().status===r&&(s.classList.add("hidden"),c.classList.remove("hidden")),null==o||o.classList.add("hidden"),f.classList.add("hidden"),document.addEventListener("keydown",h)}),c.addEventListener("click",function(){l.restart(),v(),l.setTile(),s.classList.remove("hidden"),c.classList.add("hidden"),null==o||o.classList.add("hidden"),f.classList.remove("hidden"),document.removeEventListener("keydown",h)});var g=function(e){switch(e.key){case"ArrowUp":l.moveUp(),l.setTile(),v();break;case"ArrowDown":l.moveDown(),l.setTile(),v();break;case"ArrowLeft":l.moveLeft(),l.setTile(),v();break;case"ArrowRight":l.moveRight(),l.setTile(),v()}}}();
//# sourceMappingURL=index.a18cb589.js.map
